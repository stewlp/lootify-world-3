getgenv().Webhook = "https://discord.com/api/webhooks/1206583017401884692/9CnPLWhvk2MAq7BQAz8JczPP7AXufo59G7dHgST_saQhXfGfEpUPo_68j_w0D6wOMivl"

local Players = game:GetService("Players")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local TweenService = game:GetService("TweenService")
local HttpService = game:GetService("HttpService")
local RunService = game:GetService("RunService")

local player = Players.LocalPlayer
RunService:Set3dRenderingEnabled(false)

local targetCFrame = CFrame.new(
    1990.9613, -59.3519974, 2791.26318,
    -0.752274275, -0.0443780124, -0.657353759,
     0.110036835,  0.975252867, -0.191765383,
     0.649596334, -0.216593295, -0.728774309
)

local isTweening = false

local function tweenPlayerToTarget()
    repeat task.wait() until game:IsLoaded()
    local character = player.Character or player.CharacterAdded:Wait()
    local rootPart = character:WaitForChild("HumanoidRootPart")

    local tween = TweenService:Create(
        rootPart,
        TweenInfo.new(2, Enum.EasingStyle.Sine, Enum.EasingDirection.Out),
        { CFrame = targetCFrame }
    )

    isTweening = true
    tween:Play()
    tween.Completed:Wait()
    isTweening = false
end

task.spawn(function()
    local lastTrade = 0
    while true do
        local args1 = {
            [1] = 101017
        }
        ReplicatedStorage.Remotes.Region.EnterRegion:FireServer(unpack(args1))

        if tick() - lastTrade >= 1 then
            local args2 = {
                [1] = "RemoveAll"
            }
            ReplicatedStorage.Remotes.Trade.Trade:FireServer(unpack(args2))
            lastTrade = tick()
        end

        task.wait()
    end
end)

local function sendWebhook()
    local playerName = player.Name

    pcall(function()
        request({
            Url = getgenv().Webhook,
            Method = "POST",
            Headers = {
                ["Content-Type"] = "application/json"
            },
            Body = HttpService:JSONEncode({
                content = "The " .. playerName .. " Finished"
            })
        })
    end)
end

task.spawn(function()
    while true do
        tweenPlayerToTarget()

        local countdown = 90
        while countdown > 0 do
            task.wait(1)
            countdown -= 1
        end

        local character = player.Character or player.CharacterAdded:Wait()
        local humanoid = character:FindFirstChildOfClass("Humanoid") or character:WaitForChild("Humanoid")

        if humanoid then
            humanoid.Health = 0
            sendWebhook()
        end

        task.wait(5)
    end
end)

task.spawn(function()
    while true do
        if not isTweening then
            local character = player.Character or player.CharacterAdded:Wait()
            local tool = character:FindFirstChildOfClass("Tool")

            if tool then
                tool:Activate()
            end
        end
        task.wait(0.5)
    end
end)
